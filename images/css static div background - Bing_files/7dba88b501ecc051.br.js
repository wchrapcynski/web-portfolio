var InfoBubble;(function(n){function v(n){Lib.CssClass.remove(n,"b_hide")}function y(n){Lib.CssClass.add(n,"b_hide")}function p(n){Lib.CssClass.add(n,"infobubble_fadeIn");sj_evt.fire("infobubble_show",n)}function o(n){Lib.CssClass.remove(n,"infobubble_fadeIn")}function w(n){var t=n.getBoundingClientRect();return new rt(t.left,t.top,t.bottom-t.top,t.right-t.left)}function b(n){Lib.CssClass.remove(n,"infobubble_bottom");Lib.CssClass.add(n,"infobubble_top")}function k(n){Lib.CssClass.remove(n,"infobubble_top");Lib.CssClass.add(n,"infobubble_bottom")}function ft(n){Lib.CssClass.remove(n,"infobubble_center");Lib.CssClass.remove(n,"infobubble_right");Lib.CssClass.add(n,"infobubble_left")}function d(n){Lib.CssClass.remove(n,"infobubble_left");Lib.CssClass.remove(n,"infobubble_right");Lib.CssClass.add(n,"infobubble_center")}function et(n){Lib.CssClass.remove(n,"infobubble_left");Lib.CssClass.remove(n,"infobubble_center");Lib.CssClass.add(n,"infobubble_right")}function ot(n){Lib.CssClass.remove(n,"infobubble_top");Lib.CssClass.remove(n,"infobubble_bottom");Lib.CssClass.remove(n,"infobubble_left");Lib.CssClass.remove(n,"infobubble_right");n.style.top="";n.style.right="";n.style.bottom="";n.style.left="";n.style.width=""}function g(){return _w.innerHeight||_d.documentElement.clientHeight||_d.body.clientHeight}function st(){return _w.innerWidth||_d.documentElement.clientWidth||_d.body.clientWidth}function s(n){return n+_w.pageYOffset}function h(n){return n+_w.pageXOffset}function ht(n){return _d.body.scrollHeight>g()&&(n-=it),n-_w.pageXOffset}function ct(){var n=sj_ce("div"),i,t,r;return n.style.visibility="hidden",n.style.width="100px",_d.body.appendChild(n),i=n.offsetWidth,n.style.overflow="scroll",t=sj_ce("div"),t.style.width="100%",n.appendChild(t),r=t.offsetWidth,_d.body.removeChild(n),i-r}function lt(n,t,i,r,u,e,o){if(!f[n]){var s=new ut(n,t,i,r,u,e,o);f[n]=s}}function at(n,t,r,u,f,e,o,s,h,c,l,v,y,p,w){var b=function(n,t,r,u,f,e,o,s,h,c,l,v,y,p,w){if(!i[n]){var b=new a(n,t,r,u,f,e,o,s,h,c,l,v,y,p,w);i[n]=b}},k=[n,t,r,u,f,e,o,s,h,c,l,v,y,p,w],d=_ge(n);typeof SmartRendering!="undefined"?SmartRendering.LoadElementWhenDisplayed(this,d,b,k):b.apply(this,k)}function vt(n,t){t===void 0&&(t=!0);i[n]&&i[n].setFocus(t)}function nt(n){return i[n]&&i[n].getStatus()===t.Shown}function yt(n,t){if(t===void 0&&(t=!0),nt(n))return i[n].hide(!0,t),!0;return!1}var r=8,u=16,tt=1,e=20,c=50,l=14,it=ct(),f=[],i=[],rt=function(){function n(n,t,i,r){this.left=n;this.top=t;this.height=i;this.width=r}return n}(),ut=function(){function n(n,t,i,r,u,f,e){this.id=n;this.bubbleId=t;this.node=_ge(n);this.anchor=_ge(i);this.anchor==null&&(this.anchor=this.node);this.init(r,u,f,e)}return n.prototype.getAnchorLocation=function(){return w(this.anchor)},n.prototype.hideBubbles=function(){for(var n in i)i.hasOwnProperty(n)&&i[n].hide(!0)},n.prototype.init=function(n,t,r,u){var f=this;n&&sj_be(this.node,"click",function(){i[f.bubbleId].show(!1);sj_pd(event);sj_sp(event)});t&&(sj_be(this.node,"mouseenter",function(){i[f.bubbleId].show(!0)}),sj_be(this.node,"keyup",function(n){n.keyCode==9&&i[f.bubbleId].show(!1)}));r&&(sj_be(this.node,"click",function(n){for(var t in i)i.hasOwnProperty(t)&&t!=f.bubbleId&&i[t].hide(!0);sj_sp(n)}),sj_evt.bind("slideexp_movestart",this.hideBubbles));u&&sj_be(this.node,"mouseleave",function(){i[f.bubbleId].hide()});u&&(sj_be(this.node,"keydown",function(n){n.keyCode==27&&i[f.bubbleId].hide()}),sj_be(this.node,"focusout",function(n){var u=sj_ev(n),t=u.relatedTarget,r=_ge(f.bubbleId);t!==null&&(f.node.contains(t)||r==null||r.contains(t))||i[f.bubbleId].hide()}))},n}(),t,a;(function(n){n[n.Hidden=0]="Hidden";n[n.Showing=1]="Showing";n[n.Shown=2]="Shown";n[n.Hiding=3]="Hiding"})(t||(t={}));a=function(){function n(n,i,r,u,f,e,o,s,h,c,l,a,v,y,p){var w,b;(this.horizontalPlacingOrder=[0,-1,1],this.state=t.Hidden,this.timerId=-1,this.actualWidth=0,this.actualHeight=0,this.hideOnlyByClick=!1,this.id=n,this.itemId=i,this.locatorId=r,this.width=u,this.padding=f,this.anchorVerticalOffsetPixel=e,this.extraWidth=f+tt,this.enableOverlay=s,this.enableFullWidth=h,this.enableUnfixedTriangle=c,this.enableBubbleHeader=l,this.enableClickOutsideToClose=a,this.enableHoverOutsideToClose=v,this.enableDynamicWidth=y,this.disableInitialFocus=p,this.node=_ge(n),this.node)&&(w=l?1:0,this.beforeNode=this.node.children[w],this.closeNode=this.node.children[w+1],this.content=this.node.children[w+2],this.afterNode=this.node.children[w+3],this.locatorNode=_ge(this.locatorId),this.locatorNode&&this.locatorNode.appendChild(this.node),this.appns=this.node.getAttribute("data-appns"),this.k=this.node.getAttribute("data-k"),this.defaultToTop=this.node.getAttribute("data-vp")=="top",b=this.node.getAttribute("data-hp"),b=="left"?this.horizontalPlacingOrder=[-1,0,1]:b=="right"&&(this.horizontalPlacingOrder=[1,0,-1]),this.init(o))}return n.prototype.getStatus=function(){return this.state},n.prototype.show=function(n){switch(this.state){case t.Hidden:this.state=t.Showing;this.showBubble(n);break;case t.Hiding:sb_ct(this.timerId);p(this.node);this.state=t.Shown}},n.prototype.hide=function(n,i){var r=this;if(n===void 0&&(n=!1),i===void 0&&(i=!1),!this.hideOnlyByClick||n)switch(this.state){case t.Showing:this.state=t.Hidden;o(this.node);break;case t.Shown:this.state=t.Hiding;n?this.hideBubble(i):this.timerId=sb_st(function(){o(r.node);r.timerId=sb_st(function(){r.hideBubble(i)},c)},c);break;case t.Hiding:n&&(sb_ct(this.timerId),this.hideBubble(i))}},n.prototype.setFocus=function(n){var r=this,t,i;n===void 0&&(n=!0);n&&AccessibilityHelpers.focusFirstFocusableElementWithin(this.node);t=AccessibilityHelpers.getFocusableElementWithin(this.node);i=AccessibilityHelpers.getFocusableElementWithin(this.node,!0);t!=null&&this.firstChildNode==null&&sj_be(this.node,"focusin",function(n){r.show(!1);sj_sp(n)});t!=null&&t!=this.firstChildNode&&(this.firstChildNode=t,sj_be(this.firstChildNode,"focusout",function(n){r.hide();sj_sp(n)}));i!=null&&i!=t&&i!=this.lastChildNode&&(this.lastChildNode=i,sj_be(this.lastChildNode,"focusout",function(n){r.hide();sj_sp(n)}))},n.prototype.init=function(n){var t=this;this.enableFullWidth&&Lib.CssClass.add(this.node,"fullwidth");this.enableOverlay&&(this.overlayNode=sj_ce("div",null,"infobubble_overlay"),sj_be(this.overlayNode,"click",function(){t.hide(!0)}));sj_be(this.closeNode,"click",function(){t.hide(!0,!0)});sj_be(this.closeNode,"keydown",function(n){(n.keyCode===13||n.keyCode===32)&&(sj_pd(n),t.hide(!0,!0))});this.enableOverlay||(sj_be(this.node,"mouseenter",function(){t.show(!0)}),this.enableClickOutsideToClose&&(sj_be(this.node,"click",function(n){sj_sp(n)}),sj_be(_d.body,"click",function(){t.hide(!0);sj_evt.fire("bubble_clickOutsideToClose",t.id)})),this.enableHoverOutsideToClose&&sj_be(this.node,"mouseleave",function(){var n=!Lib.CssClass.contains(t.closeNode,"b_hide");n?t.hide():t.hide(!0)}));n&&sj_evt.bind("onP1",function(){t.hideOnlyByClick=!0;t.show(!1)},!0);Orientation.onOrientation(function(n){t.onOrientation(n)})},n.prototype.getBubbleHeight=function(n){var t=this.node,r,i;return t.style.visibility="hidden",t.style.top="-5000px",t.style.width=n+"px",r=!Lib.CssClass.contains(t,"b_hide"),v(t),i=t.offsetHeight,i===0&&(_d.body.appendChild(t),i=t.offsetHeight,_d.body.removeChild(t)),r||y(t),t.style.width="",t.style.top="",t.style.visibility="",i},n.prototype.showBubble=function(n){var i=this,r;if(this.state==t.Showing){if(r=this.placeAround(f[this.itemId].getAnchorLocation()),!r){this.state=t.Hidden;return}this.enableOverlay&&_d.body.appendChild(this.overlayNode);this.locatorNode||_d.body.appendChild(this.node);v(this.node);sb_st(function(){p(i.node)},20);this.state=t.Shown;n&&this.disableInitialFocus||sb_st(function(){i.setFocus()},20);Log.Log("Show","InfoBubble",this.id,!1,"AppNS",this.appns,"K",this.k)}},n.prototype.hideBubble=function(n){if(n===void 0&&(n=!0),this.state==t.Hiding){o(this.node);y(this.node);this.locatorNode||this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node);this.enableOverlay&&this.overlayNode&&this.overlayNode.parentNode&&this.overlayNode.parentNode.removeChild(this.overlayNode);this.resetBubble();this.state=t.Hidden;var i=_ge(this.itemId);i&&n&&AccessibilityHelpers.focusFirstFocusableElementWithin(i);Log.Log("Hide","InfoBubble",this.id,!1,"AppNS",this.appns,"K",this.k)}},n.prototype.resetBubble=function(){ot(this.node);this.beforeNode.style.left="";this.afterNode.style.left=""},n.prototype.onOrientation=function(){this.state==t.Shown&&(this.resetBubble(),this.placeAround(f[this.itemId].getAnchorLocation()))},n.prototype.placeAround=function(n){if(this.locatorNode)return this.placeIn(this.locatorNode,n);var t=st(),i=g();return(this.actualWidth=this.getActualWidth(t),this.actualHeight=this.getBubbleHeight(this.actualWidth),this.enableBubbleHeader&&!this.enableFullWidth)?this.placeAroundWithHeader(n,t):(this.placeVertical(n.top,n.height,i),this.placeHorizontal(n.left,n.width,t),!0)},n.prototype.placeAroundWithHeader=function(n,t){var u=s(Math.max(0,n.top-(this.actualHeight-n.height)/2)),i=h(n.left+n.width+r);return i+this.actualWidth<t?(this.node.style.top=u+"px",this.node.style.left=i+"px",this.node.style.width=this.actualWidth+"px",Lib.CssClass.add(this.node,"chevron_left"),!0):!1},n.prototype.placeIn=function(n,t){var f=w(n),i;return f.top>=t.top+t.height?(b(this.node),f.top-r<t.top+t.height&&(this.node.style.top=r+"px")):(k(this.node),this.node.style.bottom=f.top+f.height+r>t.top?r+"px":"0"),i=t.width/2-u/2,i+=t.left-f.left,i<0?i=0:i>f.width-u&&(i=f.width-u),this.beforeNode.style.left=i+"px",this.afterNode.style.left=i+"px",!0},n.prototype.getActualWidth=function(n){return this.enableFullWidth?n-2*this.extraWidth-2*e:(this.width+2*this.extraWidth)*1.5>n?n/1.5-2*this.extraWidth:this.width},n.prototype.placeVertical=function(n,t,i){var u=this.anchorVerticalOffsetPixel>t?t:this.anchorVerticalOffsetPixel,f=i-(n+t)+u,e=n+u;if(this.defaultToTop){this.actualHeight+2*this.extraWidth+r<e||e>f?this.placeBottom(n,t,i,u):this.placeTop(n,t,i,u);return}this.actualHeight+2*this.extraWidth+r<f||f>e?this.placeTop(n,t,i,u):this.placeBottom(n,t,i,u)},n.prototype.placeTop=function(n,t,i,u){b(this.node);this.node.style.top=s(n+t+r-u)+"px"},n.prototype.placeBottom=function(n,t,i,u){k(this.node);var f=this.getBubbleHeight(this.actualWidth);this.node.style.top=s(n-f-r+u)+"px"},n.prototype.placeHorizontal=function(n,t,i){var r,u,f,o,e;if(this.node.style.width=this.enableDynamicWidth?"":this.actualWidth+"px",this.enableFullWidth&&this.enableBubbleHeader){d(this.node);return}if(this.enableUnfixedTriangle){this.placeUnfixedTriangle(n,t,i);return}for(r=n+t/2,u=this.actualWidth/2+this.extraWidth,f=0,o=this.horizontalPlacingOrder;f<o.length;f++){if(e=o[f],e==0&&r-u>=0&&r+u<=i){this.placeCenterBubble(n,t,i);return}if(e<0&&n>=u){this.placeLeftBubble(n,t,i);return}if(e>0&&n+t+u<=i){this.placeRightBubble(n,t,i);return}}if(r<i/3){this.placeRightBubble(n,t,i);return}if(r>i/3*2){this.placeLeftBubble(n,t,i);return}this.placeCenterBubble(n,t,i);return},n.prototype.placeUnfixedTriangle=function(n,t,i){var f=n+t/2-e,r=f-u/2;r=Math.max(r,this.padding);r=Math.min(r,i-2*e-this.padding-u);this.beforeNode.style.left=r+"px";this.afterNode.style.left=r+"px"},n.prototype.placeRightBubble=function(n,t){ft(this.node);var i=n+t/2,r=u/2+l;this.node.style.left=h(i-r)+"px"},n.prototype.placeCenterBubble=function(n,t){d(this.node);var i=n+t/2,r=(this.actualWidth+2*this.extraWidth)/2;this.node.style.left=h(i-r)+"px"},n.prototype.placeLeftBubble=function(n,t,i){et(this.node);var r=i-(n+t/2),f=u/2+l;this.node.style.right=ht(r-f)+"px"},n}();n.initItem=lt;n.initBubble=at;n.setBubbleFocus=vt;n.isBubbleShowing=nt;n.closeBubble=yt;sj_evt.fire("infobubble_initBubble",n);sj_evt.fire("infobubble_initItem",n)})(InfoBubble||(InfoBubble={}))